<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sumo-scan &mdash; EPICS-sumo 4.4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="sumo" href="reference-sumo.html" />
    <link rel="prev" title="Configuration Files" href="configuration-files.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> EPICS-sumo
          </a>
              <div class="version">
                4.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sumo-install.html">Installing Sumo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#parts-of-sumo">Parts of sumo</a></li>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#install-from-pypi-with-pip">Install from pypi with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#install-from-a-debian-package">Install from a debian package</a></li>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#install-from-a-rpm-package">Install from a rpm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#install-from-source-tar-gz-or-zip-file">Install from source (tar.gz or zip file)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sumo-install.html#install-as-root-to-default-directories">Install as root to default directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="sumo-install.html#install-to-a-separate-directory">Install to a separate directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="sumo-install.html#install-in-your-home">Install in your home</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sumo-install.html#the-sumo-configuration-file">The sumo configuration file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#the-problem">The problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#new-version-of-a-direct-dependency">New version of a direct dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#new-version-of-an-indirect-dependency">New version of an indirect dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#the-overall-picture">The overall picture</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#the-solution">The solution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#builds">Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#database-files-and-directories">Database files and directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#creating-a-build">Creating a build</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html#using-a-build">Using a build</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#the-implementation">The implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modulespecs.html">Module Specifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modulespecs.html#sources-of-module-specifications">Sources of module specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#the-configuration-file">The configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#the-command-line-option-m-or-module">The command line option “-m” or “–module”</a></li>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#arguments-to-a-command">Arguments to a command</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modulespecs.html#combining-all-module-specifications">Combining all module specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#override-mode">Override mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#append-mode">Append mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#processing-the-list">Processing the list</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modulespecs.html#the-format-of-a-module-specification">The format of a module specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#module-versions">Module versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="modulespecs.html#commands">Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modulespecs.html#clear">clear</a></li>
<li class="toctree-l4"><a class="reference internal" href="modulespecs.html#rm">rm</a></li>
<li class="toctree-l4"><a class="reference internal" href="modulespecs.html#load">load</a></li>
<li class="toctree-l4"><a class="reference internal" href="modulespecs.html#build">build</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration-files.html">Configuration Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#the-philosphy">The philosphy</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#file-format">File format</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#environment-variable-expansion">Environment variable expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#using-more-than-one-configuration-file">Using more than one configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#default-paths">Default paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#the-config-option">The config option</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#load-commands-in-configuration-files">Load commands in configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#the-configuration-file-for-sumo-scan">The configuration file for sumo-scan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration-files.html#keys-in-the-sumo-scan-configuration-file">Keys in the sumo-scan configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html#the-configuration-file-for-sumo">The configuration file for sumo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration-files.html#keys-in-the-sumo-configuration-file">Keys in the sumo configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration-files.html#example-of-a-sumo-configuration-file">Example of a sumo configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration-files.html#example-of-modules-files">Example of MODULES files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">sumo-scan</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-the-script-does">What the script does</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-it-works">How it works</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#phase-i-release-file-scanning">Phase I, RELEASE file scanning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phase-ii-grouping">Phase II, Grouping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phase-iii-repository-scan">Phase III, repository scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-phase-iv-name-to-paths-map">Optional Phase IV, name to paths map</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-phase-v-paths-to-names-map">Optional Phase V, paths to names map</a></li>
<li class="toctree-l3"><a class="reference internal" href="#program-output">Program output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#config-list">config list</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-show-optionnames">config show [OPTIONNAMES]</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-make-filename-optionnames">config make FILENAME [OPTIONNAMES]</a></li>
<li class="toctree-l3"><a class="reference internal" href="#all">all</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deps">deps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groups">groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#repos">repos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#name2paths">name2paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="#path2names">path2names</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference-sumo.html">sumo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference-sumo.html#what-the-script-does">What the script does</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference-sumo.html#how-it-works">How it works</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#the-dependency-database">The dependency database</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#aliases">aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#dependencies">dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#extra">extra</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#make-recipes">make-recipes</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#releasefile">releasefile</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#source">source</a><ul>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#path">path</a></li>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#tar">tar</a></li>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#darcs">darcs</a></li>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#hg">hg</a></li>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#git">git</a></li>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#svn">svn</a></li>
<li class="toctree-l5"><a class="reference internal" href="reference-sumo.html#cvs">cvs</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#weight">weight</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#the-scan-database">The scan database</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#the-build-database">The build database</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#moduledata">moduledata</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#linkdata">linkdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#state">state</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#configuration-files">Configuration Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference-sumo.html#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#maincommands">maincommands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#help-command">help COMMAND</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-subcommand">config SUBCOMMAND</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#lock-file">lock FILE</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#unlock-file">unlock FILE</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-subcommand">db SUBCOMMAND</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-subcommand">build SUBCOMMAND</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#subcommands-for-maincommand-config">subcommands for maincommand “config”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-list">config list</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-local-directory">config local DIRECTORY</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-make-filename-optionnames">config make FILENAME [OPTIONNAMES]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-new-directory-template">config new DIRECTORY TEMPLATE</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-show-optionnames">config show [OPTIONNAMES]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#config-standalone-directory">config standalone DIRECTORY</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#subcommands-for-maincommand-db">subcommands for maincommand “db”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-alias-add-module-dependency-alias">db alias-add MODULE DEPENDENCY ALIAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-appconvert-scanfile">db appconvert SCANFILE</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-check">db check</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-clonemodule-old-module-new-module-versions">db clonemodule OLD-MODULE NEW-MODULE [VERSIONS]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-cloneversion-module-old-version-new-version-sourcespec">db cloneversion MODULE OLD-VERSION NEW-VERSION [SOURCESPEC]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-commands-module-lines">db commands MODULE LINES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-convert-scanfile">db convert SCANFILE</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-dependency-add-module-dependency">db dependency-add MODULE DEPENDENCY</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-dependency-delete-module-dependency">db dependency-delete MODULE DEPENDENCY</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-edit">db edit</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-extra-module-lines">db extra MODULE [LINES]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-find-regexp">db find REGEXP</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-format">db format</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-list-modules">db list MODULES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-make-recipes-module-target-lines">db make-recipes MODULE [TARGET] [LINES]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-merge-db">db merge DB</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-modconvert-scanfile-modules">db modconvert SCANFILE MODULES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-releasefilename-module-releasefilename">db releasefilename MODULE RELEASEFILENAME</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-replaceversion-module-old-version-new-version">db replaceversion MODULE OLD-VERSION NEW-VERSION</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-show-modules">db show MODULES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#db-weight-weight-modules">db weight WEIGHT MODULES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#subcommands-for-maincommand-build">subcommands for maincommand “build”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-delete-buildtags">build delete BUILDTAGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-find-modules">build find MODULES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-getmodules-buildtag-modules">build getmodules BUILDTAG [MODULES]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-list">build list</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-new-modules">build new MODULES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-remake-buildtag">build remake BUILDTAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-show-buildtag">build show BUILDTAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-showmodules-buildtag">build showmodules [BUILDTAG]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-showdependencies-buildtag">build showdependencies [BUILDTAG]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-showdependents-buildtag">build showdependents [BUILDTAG]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-state-buildtag-new-state">build state BUILDTAG [NEW-STATE]</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-try-modules">build try MODULES</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference-sumo.html#build-use-modules">build use MODULES</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference-sumo.html#command-completion">Command completion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#activate-command-completion-on-the-fly">Activate command completion on the fly</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#activate-command-completion-permanently">Activate command completion permanently</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#completion-cache-files">Completion cache files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference-sumo.html#the-help-pager">The help pager</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference-sumo.html#options">Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#opt-postload-files"><code class="docutils literal notranslate"><span class="pre">--#opt-postload</span> <span class="pre">FILES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#opt-preload-files"><code class="docutils literal notranslate"><span class="pre">--#opt-preload</span> <span class="pre">FILES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#postload-files"><code class="docutils literal notranslate"><span class="pre">--#postload</span> <span class="pre">FILES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#preload-files"><code class="docutils literal notranslate"><span class="pre">--#preload</span> <span class="pre">FILES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#a-alias-alias-alias"><code class="docutils literal notranslate"><span class="pre">-a</span> <span class="pre">ALIAS,</span> <span class="pre">--alias</span> <span class="pre">ALIAS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#all-builds"><code class="docutils literal notranslate"><span class="pre">--all-builds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#a-append-optionname"><code class="docutils literal notranslate"><span class="pre">-A,</span> <span class="pre">--append</span> <span class="pre">OPTIONNAME</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#b-brief"><code class="docutils literal notranslate"><span class="pre">-b,</span> <span class="pre">--brief</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#builddir-builddir"><code class="docutils literal notranslate"><span class="pre">--builddir</span> <span class="pre">BUILDDIR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#t-buildtag-buildtag-buildtag"><code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">BUILDTAG,</span> <span class="pre">--buildtag</span> <span class="pre">BUILDTAG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#buildtag-stem-stem"><code class="docutils literal notranslate"><span class="pre">--buildtag-stem</span> <span class="pre">STEM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#c-file-config-file"><code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">FILE,</span> <span class="pre">--config</span> <span class="pre">FILE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#dbdir-dbdir"><code class="docutils literal notranslate"><span class="pre">--dbdir</span> <span class="pre">DBDIR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#dbrepo-repository"><code class="docutils literal notranslate"><span class="pre">--dbrepo</span> <span class="pre">REPOSITORY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#dbrepomode-mode"><code class="docutils literal notranslate"><span class="pre">--dbrepomode</span> <span class="pre">MODE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#detail-no"><code class="docutils literal notranslate"><span class="pre">--detail</span> <span class="pre">NO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#d-expression-dir-patch-expression"><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">EXPRESSION,</span> <span class="pre">--dir-patch</span> <span class="pre">EXPRESSION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#disable-loading"><code class="docutils literal notranslate"><span class="pre">--disable-loading</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#n-dry-run"><code class="docutils literal notranslate"><span class="pre">-n,</span> <span class="pre">--dry-run</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#dump-modules"><code class="docutils literal notranslate"><span class="pre">--dump-modules</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#dumpdb"><code class="docutils literal notranslate"><span class="pre">--dumpdb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#editor-editor"><code class="docutils literal notranslate"><span class="pre">--editor</span> <span class="pre">EDITOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#exceptions"><code class="docutils literal notranslate"><span class="pre">--exceptions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#x-regexp-exclude-states-regexp"><code class="docutils literal notranslate"><span class="pre">-X</span> <span class="pre">REGEXP,</span> <span class="pre">--exclude-states</span> <span class="pre">REGEXP</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#x-extraline-extra-extralline"><code class="docutils literal notranslate"><span class="pre">-x</span> <span class="pre">EXTRALINE,</span> <span class="pre">--extra</span> <span class="pre">EXTRALLINE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#getmodules-buildtag"><code class="docutils literal notranslate"><span class="pre">--getmodules</span> <span class="pre">BUILDTAG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#h-options-help-options"><code class="docutils literal notranslate"><span class="pre">-h</span> <span class="pre">[OPTIONS],</span> <span class="pre">--help</span> <span class="pre">[OPTIONS]</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#jobs"><code class="docutils literal notranslate"><span class="pre">--jobs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#lines"><code class="docutils literal notranslate"><span class="pre">--lines</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#list"><code class="docutils literal notranslate"><span class="pre">--list</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#localbuilddir-builddir"><code class="docutils literal notranslate"><span class="pre">--localbuilddir</span> <span class="pre">BUILDDIR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#logmsg-logmessage"><code class="docutils literal notranslate"><span class="pre">--logmsg</span> <span class="pre">LOGMESSAGE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#makeflags-makeflags"><code class="docutils literal notranslate"><span class="pre">--makeflags</span> <span class="pre">MAKEFLAGS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#m-module-module-module"><code class="docutils literal notranslate"><span class="pre">-m</span> <span class="pre">MODULE,</span> <span class="pre">--module</span> <span class="pre">MODULE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#no-checkout"><code class="docutils literal notranslate"><span class="pre">--no-checkout</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#c-no-default-config"><code class="docutils literal notranslate"><span class="pre">-C,</span> <span class="pre">--no-default-config</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#n-no-err-build-exists"><code class="docutils literal notranslate"><span class="pre">-N,</span> <span class="pre">--no-err-build-exists</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#no-make"><code class="docutils literal notranslate"><span class="pre">--no-make</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#noignorecase"><code class="docutils literal notranslate"><span class="pre">--noignorecase</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#nolock"><code class="docutils literal notranslate"><span class="pre">--nolock</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#o-outputfile-output-outputfile"><code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">OUTPUTFILE,</span> <span class="pre">--output</span> <span class="pre">OUTPUTFILE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#p-progress"><code class="docutils literal notranslate"><span class="pre">-p,</span> <span class="pre">--progress</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#readonly"><code class="docutils literal notranslate"><span class="pre">--readonly</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#recursive"><code class="docutils literal notranslate"><span class="pre">--recursive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#scandb-scandb"><code class="docutils literal notranslate"><span class="pre">--scandb</span> <span class="pre">SCANDB</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#sort-build-dependencies-first"><code class="docutils literal notranslate"><span class="pre">--sort-build-dependencies-first</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#sort-build-dependencies-last"><code class="docutils literal notranslate"><span class="pre">--sort-build-dependencies-last</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#summary"><code class="docutils literal notranslate"><span class="pre">--summary</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#test"><code class="docutils literal notranslate"><span class="pre">--test</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#trace"><code class="docutils literal notranslate"><span class="pre">--trace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#tracemore"><code class="docutils literal notranslate"><span class="pre">--tracemore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#u-expression-url-patch-expression"><code class="docutils literal notranslate"><span class="pre">-U</span> <span class="pre">EXPRESSION,</span> <span class="pre">--url-patch</span> <span class="pre">EXPRESSION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#v-verbose"><code class="docutils literal notranslate"><span class="pre">-v,</span> <span class="pre">--verbose</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#version"><code class="docutils literal notranslate"><span class="pre">--version</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference-sumo.html#y-yes"><code class="docutils literal notranslate"><span class="pre">-y,</span> <span class="pre">--yes</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="app-usage.html">Using sumo in your application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="app-usage.html#use-supports-in-an-application">Use supports in an application</a></li>
<li class="toctree-l2"><a class="reference internal" href="app-usage.html#use-a-different-version-of-a-support">Use a different version of a support</a></li>
<li class="toctree-l2"><a class="reference internal" href="app-usage.html#details">Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="app-usage.html#modules">MODULES</a></li>
<li class="toctree-l3"><a class="reference internal" href="app-usage.html#release-for-bl-001">RELEASE for BL-001</a></li>
<li class="toctree-l3"><a class="reference internal" href="app-usage.html#release-for-bl-002">RELEASE for BL-002</a></li>
<li class="toctree-l3"><a class="reference internal" href="app-usage.html#makefile-for-bl-002">Makefile for BL-002</a></li>
<li class="toctree-l3"><a class="reference internal" href="app-usage.html#builds-db">BUILDS.DB</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev-usage.html">Develop support modules with sumo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#create-the-sandbox">Create the sandbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#create-a-head-version-of-a-module">Create a “HEAD” version of a module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#build-the-module-for-the-first-time">Build the module for the first time</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#change-and-recompile">Change and recompile</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#test-in-an-application">Test in an application</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#commit-the-changes-and-define-a-tag">Commit the changes and define a tag</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-usage.html#add-the-new-support-to-the-dependency-database">Add the new support to the dependency database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example-sumo-build-try.html">Example for sumo build try</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">sumo demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="demo.html#build-an-epics-example">Build an EPICS example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="demo.html#prepare-the-directory">Prepare the directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo.html#set-up-the-support-and-application-directories">Set up the support and application directories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="demo.html#set-up-sumo">Set up sumo</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo.html#migrate-the-example-for-usage-with-sumo">Migrate the example for usage with sumo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="demo.html#scan-the-support-directory-and-create-a-dependency-database">Scan the support directory and create a dependency database</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo.html#create-a-copy-of-the-sources-of-the-original-application">Create a copy of the sources of the original application</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo.html#scan-the-application-to-create-a-modules-file">Scan the application to create a MODULES file</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo.html#rebuild-the-application-now-with-sumo">Rebuild the application, now with sumo</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="demo.html#what-to-do-now">What to do now</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migration-examples.html">Migrating supports and applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="migration-examples.html#migrating-the-support-directory">Migrating the support directory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#set-up-the-sumo-directory">Set up the sumo directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#scan-the-support-directory-with-sumo-scan">Scan the support directory with sumo-scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#apply-changes-to-the-scan-file-optional">Apply changes to the scan file (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#create-the-dependency-database">Create the dependency database</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#create-the-sumo-configuration-file">Create the sumo configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="migration-examples.html#migrating-a-single-support">Migrating a single support</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration-examples.html#migrating-an-application">Migrating an application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#create-configuration-file-and-module-list">Create configuration file and module list</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#build-all-support-modules-the-application-requires">Build all support modules the application requires</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration-examples.html#use-the-support-modules-in-the-application">Use the support modules in the application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#patch-files">Patch files</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#mercurial-patch-bundle">Mercurial patch bundle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">SUMO license</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EPICS-sumo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>sumo-scan</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reference-sumo-scan.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sumo-scan">
<h1>sumo-scan<a class="headerlink" href="#sumo-scan" title="Permalink to this headline"></a></h1>
<section id="what-the-script-does">
<h2>What the script does<a class="headerlink" href="#what-the-script-does" title="Permalink to this headline"></a></h2>
<p>This script scans an existing <a class="reference external" href="http://www.aps.anl.gov/epics">EPICS</a> support
module directory tree and collects all information necessary to generate a
dependency database <a class="reference internal" href="glossary.html#term-DEPS.DB"><span class="xref std std-term">DEPS.DB</span></a> file.  The data is formatted in
<a class="reference external" href="http://www.json.org">JSON</a> format and printed to the console. You can either
save this output in a file or combine this script with
<a class="reference internal" href="reference-sumo.html"><span class="doc">sumo db</span></a> in a pipe to directly create a <a class="reference internal" href="glossary.html#term-DEPS.DB"><span class="xref std std-term">DEPS.DB</span></a>
file.</p>
<p>The script takes one or mode commands and has a number of options. Single
character options always start with a single dash “-”, long options start with
a double dash “–”, commands are simple words on the command line.</p>
</section>
<section id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline"></a></h2>
<p>The program collects information in several phases. The output of each phase is
taken as an input for the next phase. If you use the command “all”, the first
three phases are run at a time. If you run some phases alone by using the
commands “deps”, “groups” or “repos” you have to provide the input of a phase
from a file by using the command line option <code class="docutils literal notranslate"><span class="pre">--info-file</span></code>.</p>
<p>All three phases that are needed to create the data for generating a dependency
database with <a class="reference internal" href="reference-sumo.html"><span class="doc">sumo db</span></a> are combined with the command
“all”.</p>
<p>Two other phases “name2paths” and “path2names” are implemented to get
information on the existing module support tree but are not needed to create a
dependency database.</p>
<section id="phase-i-release-file-scanning">
<h3>Phase I, RELEASE file scanning<a class="headerlink" href="#phase-i-release-file-scanning" title="Permalink to this headline"></a></h3>
<p>Information on dependencies of <a class="reference external" href="http://www.aps.anl.gov/epics">EPICS</a> modules
is stored in files named “RELEASE” in directory “configure”. For each module
the module depends on, there is a variable with a path. This is a short example
of what you could find in a RELEASE file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SUPPORT=/opt/Epics/R3.14.8/support
MISC=$(SUPPORT)/misc/2-4
ALARM=$(SUPPORT)/alarm/3-1
SOFT=$(SUPPORT)/soft/2-2
</pre></div>
</div>
<p>The script calls “make” for each “RELEASE” file found to generate a list of all
generated variables. By calling make it is ensured that all macros, e.g.
“SUPPORT” in the example above, are resolved. By calling “make” twice, one time
without and one time with the “RELEASE” file the script computes a difference
of the set of defined variables of both runs. This difference contains all the
changes in variables that are caused by parsing the “RELEASE” file.</p>
<p>From this set of variable names and values the script removes names which match
a given list. For example, “TOP” usually refers to a directory that is not an
<a class="reference external" href="http://www.aps.anl.gov/epics">EPICS</a> support.</p>
<p>The remaining variable definitions are assumed to be module dependencies.</p>
<p>The program builds a map where the keys are absolute paths of support modules.
The values are maps which map variable names to absolute paths which are in
fact the module’s dependencies. Here is a short <a class="reference external" href="http://www.json.org">JSON</a>
example of the created data structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;dependencies&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-3&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;EPICS_BASE&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/base/3-14-8-2-0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MISC&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/misc/2-4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TIMER&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/bspDep/timer/4-0&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-4&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;EPICS_BASE&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/base/3-14-8-2-0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MISC&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/misc/2-4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TIMER&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/bspDep/timer/5-0&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/csm/3-2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;EPICS_BASE&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/base/3-14-8-2-0&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/csm/3-3&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;EPICS_BASE&quot;</span><span class="p">:</span> <span class="s2">&quot;/srv/csr/Epics/R3.14.8/base/3-14-8-2-0&quot;</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="phase-ii-grouping">
<span id="reference-sumo-scan-phase-ii-grouping"></span><h3>Phase II, Grouping<a class="headerlink" href="#phase-ii-grouping" title="Permalink to this headline"></a></h3>
<p>In this phase the program tries to build groups of modules. A group is a
collection all the versions of a support module. This is done by parsing module
paths. The program assumes that each module has a path of the form
“[BASEDIR]/[MODULEPATH]/[VERSION]”. [VERSION] is simply the last part of the
path that contains no slashes “/”. [BASEDIR] is given as a command line option
to the program (see option <code class="docutils literal notranslate"><span class="pre">--group-basedir</span></code>) and [MODULEPATH] is all that
remains of the path. In order to create a <em>modulename</em> the program changes all
characters in [MODULEPATH] to uppercase and replaces all slashes “/” with
underscore “_” characters. Here is an example of the created datastructure in
<a class="reference external" href="http://www.json.org">JSON</a> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AGILENT&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/agilent&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;2-0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;2-1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;2-2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;head&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;ALARM&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;3-0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;3-1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;3-2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;3-3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;3-4&quot;</span><span class="p">,</span>
                <span class="s2">&quot;3-5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;base-3-14&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="phase-iii-repository-scan">
<span id="reference-sumo-scan-phase-iii-repository-scan"></span><h3>Phase III, repository scan<a class="headerlink" href="#phase-iii-repository-scan" title="Permalink to this headline"></a></h3>
<p>Usually your support modules are managed by a version control system. Currently
the program supports <em>darcs</em>, <em>mercurial</em>, <em>git</em>, <em>subversion</em> and <em>cvs</em>.</p>
<p>In each module the program looks for the data of a supported version control
system. If no version control data is found, the program marks the source of
the module as a <em>path</em> meaning that <cite>sumo build &lt;reference-sumo&gt;</cite> will
copy the sources from exactly that path.</p>
<p>If version control data is found the program it looks for a repository tag. It
only accepts a tag if it matches the last part of the support module path. The
program creates a version number from both, the path and the tag and only if
this number is equal, the tag is accepted. Here are some examples:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60%" />
<col style="width: 15%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>path</p></th>
<th class="head"><p>tag</p></th>
<th class="head"><p>tag accepted</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/Epics/support/NewDyncon/3-1</p></td>
<td><p>R3-1</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>/Epics/support/NewDyncon/3-0</p></td>
<td><p>ver-3-0</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>/Epics/support/NewDyncon/2-9</p></td>
<td><p>R2-8</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>/Epics/support/NewDyncon/2-7</p></td>
<td><p>R2-8</p></td>
<td><p>no</p></td>
</tr>
</tbody>
</table>
<p>The program also looks for the path of the foreign repository, this is assumed
to be the central repository we should refer to. If this is not found, the
program takes the path of the working copy as the source repository. In this
case, any version tag is ignored.</p>
<p>Here is an example of the generated data
in <a class="reference external" href="http://www.json.org">JSON</a> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;repos&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;/srv/csr/Epics/R3.14.10/base/3-14-10-0-1&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;R3-14-10-0-1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;darcs&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;rcsadm@aragon.acc.bessy.de:/opt/repositories/controls/darcs/epics/base/3-14-10&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;/srv/csr/Epics/R3.14.12/base/3-14-12-2-1&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;darcs&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;rcsadm@aragon.acc.bessy.de:/opt/repositories/controls/darcs/epics/base/3-14-12-2&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/apps/wlsSupport/work&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;rcsadm@aragon.acc.bessy.de:/opt/Epics/R3.14.8/support/apps/wlsSupport/work&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/NewDyncon/3-0&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;R3-0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;darcs&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;rcsadm@aragon.acc.bessy.de:/opt/repositories/controls/darcs/epics/support/dyncon&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/NewDyncon/3-1&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;R3-1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;darcs&quot;</span><span class="p">,</span>
          <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;rcsadm@aragon.acc.bessy.de:/opt/repositories/controls/darcs/epics/support/dyncon&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Optional</p>
</section>
<section id="optional-phase-iv-name-to-paths-map">
<h3>Optional Phase IV, name to paths map<a class="headerlink" href="#optional-phase-iv-name-to-paths-map" title="Permalink to this headline"></a></h3>
<p>This optional phase that is started with the command “name2paths” creates a map
that shows what paths were found for modules. Here is an example of the created
datastructure in <a class="reference external" href="http://www.json.org">JSON</a> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;name2paths&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ALARM&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-5&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;MOTOR&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/motor/6-4-4-1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/motor/6-5-1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/motor/6-5-2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/synApps/5-1-1-0/support/motor/5-9&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/synApps/5-2-0-1/support/motor/6-1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/synApps/5-2-0/support/motor/6-1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/synApps/5-4-1/support/motor/6-4-3&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="optional-phase-v-paths-to-names-map">
<h3>Optional Phase V, paths to names map<a class="headerlink" href="#optional-phase-v-paths-to-names-map" title="Permalink to this headline"></a></h3>
<p>This optional phase that is started with the command “path2names” creates a map
that shows what module names were used for what module paths. Here is an
example of the created datastructure in <a class="reference external" href="http://www.json.org">JSON</a> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;path2names&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-0&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;ALARM&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-1&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;ALARM&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/alarm/3-2&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;ALARM&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;/srv/csr/Epics/R3.14.8/support/synApps/5-2-0-1/support/genSub/1-6a&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;GENSUB&quot;</span><span class="p">,</span>
            <span class="s2">&quot;GEN_SUB&quot;</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="program-output">
<h3>Program output<a class="headerlink" href="#program-output" title="Permalink to this headline"></a></h3>
<p>The output of all phases that are run is combined in a single
<a class="reference external" href="http://www.json.org">JSON</a> datastructure that is printed on the console.</p>
<p>From the paths of each RELEASE file, a module name is constructed. Each path of
a support module from a RELEASE is added to the list of dependencies of that
module.</p>
<p>Since all the consecutive calls of “make” may take some time, the results of
the RELEASE file scan can be saved as a file and used later on with other
commands like “path2names” or “groups”. This is the meaning of the <code class="docutils literal notranslate"><span class="pre">-i</span></code> or
<code class="docutils literal notranslate"><span class="pre">--info-file</span></code> option.</p>
</section>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Permalink to this headline"></a></h2>
<p>This is a list of all commands. Note that if no command is provided, the
program assumes command “all”. This is the command you want to use in most
cases.</p>
<section id="config-list">
<h3>config list<a class="headerlink" href="#config-list" title="Permalink to this headline"></a></h3>
<p>List all configuration files that were loaded.</p>
</section>
<section id="config-show-optionnames">
<h3>config show [OPTIONNAMES]<a class="headerlink" href="#config-show-optionnames" title="Permalink to this headline"></a></h3>
<p>Show the configuration in JSON format.  OPTIONNAMES is an optional list of long
option names. If OPTIONNAMES are specified, only options from this list are
saved in the configuration file.</p>
</section>
<section id="config-make-filename-optionnames">
<h3>config make FILENAME [OPTIONNAMES]<a class="headerlink" href="#config-make-filename-optionnames" title="Permalink to this headline"></a></h3>
<p>Create a new configuration file from the options read from configuration files
and options from the command line. If FILENAME is ‘-’ dump to the console.
OPTIONNAMES is an optional list of long option names. If OPTIONNAMES are
specified, only options from this list are saved in the configuration file.</p>
</section>
<section id="all">
<h3>all<a class="headerlink" href="#all" title="Permalink to this headline"></a></h3>
<p>This is the most important command. “all” combines the commands “deps”,
“groups” and “repos”. The output of the commands is combined in a single large
<a class="reference external" href="http://www.json.org">JSON</a> structure and printed to the console. You can use
the output of this command as input for <a class="reference internal" href="reference-sumo.html"><span class="doc">sumo db</span></a> in
order to create a dependency database.</p>
</section>
<section id="deps">
<h3>deps<a class="headerlink" href="#deps" title="Permalink to this headline"></a></h3>
<p>This command collects dependencies from all “RELEASE” files and returns the
structure in <a class="reference external" href="http://www.json.org">JSON</a> format. For details see
<a class="reference internal" href="#phase-i-release-file-scanning">Phase I, RELEASE file scanning</a>.</p>
</section>
<section id="groups">
<h3>groups<a class="headerlink" href="#groups" title="Permalink to this headline"></a></h3>
<p>This command collects modules of the same name but of different versions in
groups. For details see <a class="reference internal" href="#phase-ii-grouping">Phase II, Grouping</a>.</p>
</section>
<section id="repos">
<h3>repos<a class="headerlink" href="#repos" title="Permalink to this headline"></a></h3>
<p>This command collects information about repositories and returns the structure
in <a class="reference external" href="http://www.json.org">JSON</a> format. For details see
<a class="reference internal" href="#phase-iii-repository-scan">Phase III, repository scan</a>.</p>
</section>
<section id="name2paths">
<h3>name2paths<a class="headerlink" href="#name2paths" title="Permalink to this headline"></a></h3>
<p>This command shows what module paths were found for module names. You do not
need this command in order to generate a dependency database. For details see
<a class="reference internal" href="#optional-phase-iv-name-to-paths-map">Optional Phase IV, name to paths map</a>.</p>
</section>
<section id="path2names">
<h3>path2names<a class="headerlink" href="#path2names" title="Permalink to this headline"></a></h3>
<p>This command shows what module names were used for what module paths. You do not
need this command in order to generate a dependency database. For details see
<a class="reference internal" href="#optional-phase-v-paths-to-names-map">Optional Phase V, paths to names map</a>.</p>
</section>
</section>
<section id="options">
<span id="reference-sumo-scan-options"></span><h2>Options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h2>
<p>Here is a short overview on command line options:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">--version</span></code></dt><dd><p>show program’s version number and exit</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-h,</span> <span class="pre">--help</span></code></dt><dd><p>show this help message and exit</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--summary</span></code></dt><dd><p>Print a summary of the function of the program.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--test</span></code></dt><dd><p>Perform some self tests.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">FILE,</span> <span class="pre">--config</span> <span class="pre">FILE</span></code></dt><dd><p>Load options from the given configuration file. You can specify more than
one of these.  Unless –no-default-config is given, the program always
loads configuration files from several standard directories first before it
loads your configuration file. The contents of all configuration files are
merged.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-C,</span> <span class="pre">--no-default-config</span></code></dt><dd><p>If this option is given the program doesn’t load the default configuration.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--disable-loading</span></code></dt><dd><p>If given, disable execution of load commands like ‘#preload’ in
configuration files. In this case these keys are treated like ordinary
keys.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-A</span></code>, <code class="docutils literal notranslate"><span class="pre">--append</span> <span class="pre">OPTIONNAME</span></code></dt><dd><p>If an option with name OPTIONNAME is given here and it is a list option,
the list from the command line is <em>appended</em> to the list from the
configuration file. The default is that options from the command line
<em>override</em> option values from the configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--#preload</span> <span class="pre">FILES</span></code></dt><dd><p>Specify a an ‘#preload’ directive in the configuration file. This option
has only a meaning if a configuration file is created with the ‘makeconfig’
command. ‘#preload’ means that the following file(s) are loaded before the
rest of the configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--#opt-preload</span> <span class="pre">FILES</span></code></dt><dd><p>This option does the same as –#preload but the file loading is optional.
If they do not exist the program continues without an error.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--#postload</span> <span class="pre">FILES</span></code></dt><dd><p>Specify a an ‘#postload’ directive in the configuration file. This option
has only a meaning if a configuration file is created with the ‘makeconfig’
command. ‘#postload’ means that the following file(s) are loaded after the
rest of the configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--#opt-postload</span> <span class="pre">FILES</span></code></dt><dd><p>This option does the same as –#postload but the file loading is optional.
If they do not exist the program continues without an error.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-d</span> <span class="pre">DIR,</span> <span class="pre">--dir</span> <span class="pre">DIR</span></code></dt><dd><p>Parse all RELEASE files in directory DIR. You can specify more than one of
these by repeating this option or by joining values in a single string
separated by spaces. A default for this option can be put in a
configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">INFOFILE,</span> <span class="pre">--info-file</span> <span class="pre">INFOFILE</span></code></dt><dd><p>Read information from INFOFILE. This is a scan file generated by this
script in a prevous run.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-N</span> <span class="pre">NAME,</span> <span class="pre">--ignore-name</span> <span class="pre">NAME</span></code></dt><dd><p>Define names of variables in RELEASE files that should be ignored. You
usually want to ignore the names like ‘TOP’ or ‘SUPPORT’. You can specify
more than one of these by repeating this option or by joining values in a
single string separated by spaces. A default for this option can be put in
a configuration file. If this option isn’t provided, the program uses these
defaults: TOP EPICS_SUPPORT SUPPORT MSI TEMPLATE_TOP</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-g</span> <span class="pre">DIR,</span> <span class="pre">--group-basedir</span> <span class="pre">DIR</span></code></dt><dd><p>Option “-g” or “–group-basedir” must be followed by a directory name. It
defines the part of the directory path that is the same for all support
modules. This is needed in order to generate a module name from the
module’s directory path.  You can specify more than one of these by
repeating this option or by joining values in a single string separated by
spaces. A default for this option can be put in a configuration file.
Directories (option –dir) are always appended to the list of
group-basedirs.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--exclude-path</span> <span class="pre">REGEXP</span></code></dt><dd><p>Exclude all paths that match REGEXP from dependencies.  You can specify
more than one of these by repeating this option or by joining values in a
single string separated by spaces. A default for this option can be put in
a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--exclude-deps</span> <span class="pre">REGEXP</span></code></dt><dd><p>Exclude all paths whose dependencies match REGEXP. A default for this
option can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--ignore-changes</span> <span class="pre">REGEXP</span></code></dt><dd><p>Ignore all uncomitted changes in files that match the REGEXP. Usually
uncomitted changes mean that we cannot use the repository as such but must
copy the whole directory (source type is always ‘path’). A common
application for this option is to ignore changes in ‘configure/RELEASE’.
You can specify more than one of these by repeating this option or by
joining values in a single string separated by spaces. A default for this
option can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">EXPRESSION,</span> <span class="pre">--dir-patch</span> <span class="pre">EXPRESSION</span></code></dt><dd><p>Specify a directory patchexpression. Such an expression consists of a tuple
of 2 python strings. The first is the match expression, the second one is
the replacement string. The regular expression is applied to every source
path generated. You can specify more than one patchexpression. A default
for this option can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-U</span> <span class="pre">EXPRESSION,</span> <span class="pre">--url-patch</span> <span class="pre">EXPRESSION</span></code></dt><dd><p>Specify a repository url patchexpression. Such an expression consists of a
tuple of 2 python strings. The first is the match expression, the second
one is the replacement string. The regular expression is applied to every
source url generated. You can specify more than one patchexpression. A
default for this option can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--hint</span> <span class="pre">HINT</span></code></dt><dd><p>Specify a HINT. A HINT has the form REGEXP,FLAG{,FLAG}.  REGEXP is a
regular expression that is matched with the module path. FLAG is a string
that gives hints how to treat that module.  You can specify more than one
hint. Currently known FLAGS are “path” and “tagless”. A default for this
option can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--missing-tag</span></code></dt><dd><p>Show directories where a repository was found but no tag. A default for
this option can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--missing-repo</span></code></dt><dd><p>Show directories where no repository was found. A default for this option
can be put in a configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">BUILDTAG,</span> <span class="pre">--buildtag</span> <span class="pre">BUILDTAG</span></code></dt><dd><p>Scan only directories of the given buildtag.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-p,</span> <span class="pre">--progress</span></code></dt><dd><p>Show progress on stderr. A default for this option can be put in a
configuration file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-t,</span> <span class="pre">--trace</span></code></dt><dd><p>Switch on some trace messages.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--exceptions</span></code></dt><dd><p>On fatal errors that raise python exceptions, don’t catch these. This will
show a python stacktrace instead of an error message and may be useful for
debugging the program.”</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-v,</span> <span class="pre">--verbose</span></code></dt><dd><p>Show command calls. A default for this option can be put in a
configuration file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-n,</span> <span class="pre">--dry-run</span></code></dt><dd><p>Just show what the program would do.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configuration-files.html" class="btn btn-neutral float-left" title="Configuration Files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reference-sumo.html" class="btn btn-neutral float-right" title="sumo" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Helmholtz-Zentrum Berlin GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>